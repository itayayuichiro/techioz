<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../style.css">
  <title>React Native ポッドのインストール時に「nil から String への暗黙的な変換が行われない」を修正する方法 | Techioz</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1637770322917058"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRM1ZRNLDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DRM1ZRNLDN');
  </script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "headline": "React Native ポッドのインストール時に「nil から String への暗黙的な変換が行われない」を修正する方法",
  "author": {
    "@type": "Person",
    "address": "",
    "email": null,
    "identifier": "masyumaroking",
    "name": "masyumaroking"
  },
  "publisher": {
    "@type": "Person",
    "name": "masyumaroking"
  }
}
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <div class="container">
        <h1>Techioz Blog</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>
  <main>
    <div class="container">
        <article>
                      <h2>React Native ポッドのインストール時に「nil
から String への暗黙的な変換が行われない」を修正する方法</h2>
                    <h2 id="概要">概要</h2>
                    <p>React Native を 0.72 から 0.73.8
                    にアップグレードしましたが、pod install
                    でポッドをインストールしようとすると、次のエラーが発生します。</p>
                    <pre><code>Downloading dependencies
Generating Pods project
Setting USE_HERMES build settings
Setting REACT_NATIVE build settings
[!] An error occurred while processing the post-install hook of the Podfile.

no implicit conversion of nil into String

/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:130:in `join&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:130:in `block (2 levels) in set_node_modules_user_settings&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:129:in `each&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:129:in `block in set_node_modules_user_settings&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:128:in `each&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/cocoapods/utils.rb:128:in `set_node_modules_user_settings&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/node_modules/react-native/scripts/react_native_pods.rb:307:in `react_native_post_install&#39;
/Users/francescoclementi/Documents/develop/parkinglesscustomer/ios/Podfile:55:in `block (2 levels) in from_ruby&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-core-1.15.2/lib/cocoapods-core/podfile.rb:196:in `post_install!&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:1013:in `run_podfile_post_install_hook&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:1001:in `block in run_podfile_post_install_hooks&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/user_interface.rb:149:in `message&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:1000:in `run_podfile_post_install_hooks&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:337:in `block (2 levels) in create_and_save_projects&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer/xcode/pods_project_generator/pods_project_writer.rb:61:in `write!&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:336:in `block in create_and_save_projects&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/user_interface.rb:64:in `section&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:315:in `create_and_save_projects&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:307:in `generate_pods_project&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:183:in `integrate&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/installer.rb:170:in `install!&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/command/install.rb:52:in `run&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/claide-1.1.0/lib/claide/command.rb:334:in `run&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/lib/cocoapods/command.rb:52:in `run&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/lib/ruby/gems/2.7.0/gems/cocoapods-1.15.2/bin/pod:55:in `&lt;top (required)&gt;&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/bin/pod:23:in `load&#39;
/Users/francescoclementi/.rbenv/versions/2.7.4/bin/pod:23:in `&lt;main&gt;&#39;
</code></pre>
                    <p>これは私のポッドファイルです:</p>
                    <pre><code># Resolve react_native_pods.rb with node to allow for hoisting
require Pod::Executable.execute_command(&#39;node&#39;, [&#39;-p&#39;,
  &#39;require.resolve(
    &quot;react-native/scripts/react_native_pods.rb&quot;,
    {paths: [process.argv[1]]},
  )&#39;, __dir__]).strip

platform :ios, min_ios_version_supported
prepare_react_native_project!


def share_pods (target_name)
  # If you are using a `react-native-flipper` your iOS build will fail when `NO_FLIPPER=1` is set.
  # because `react-native-flipper` depends on (FlipperKit,...) that will be excluded
  #
  # To fix this you can also exclude `react-native-flipper` using a `react-native.config.js`
  # ```js
  # module.exports = {
  #   dependencies: {
  #     ...(process.env.NO_FLIPPER ? { &#39;react-native-flipper&#39;: { platforms: { ios: null } } } : {}),
  # ```
  flipper_config = ENV[&#39;NO_FLIPPER&#39;] == &quot;1&quot; ? FlipperConfiguration.disabled : FlipperConfiguration.enabled

  linkage = ENV[&#39;USE_FRAMEWORKS&#39;]
  if linkage != nil
    Pod::UI.puts &quot;Configuring Pod with #{linkage}ally linked Frameworks&quot;.green
    use_frameworks! :linkage =&gt; linkage.to_sym
  end

  target target_name do

    $config = use_native_modules!

    use_frameworks! :linkage =&gt; :static
    $RNFirebaseAsStaticFramework = true

    use_react_native!(
      :path =&gt; $config[:reactNativePath],
      # Enables Flipper.
      #
      # Note that if you have use_frameworks! enabled, Flipper will not work and
      # you should disable the next line.
      # :flipper_configuration =&gt; flipper_config,
      # An absolute path to your application root.
      :app_path =&gt; &quot;#{Pod::Config.instance.installation_root}/..&quot;
    )
  end
end

share_pods(&#39;target1&#39;)
share_pods(&#39;target1-prod&#39;) 

post_install do |installer|
  # https://github.com/facebook/react-native/blob/main/packages/react-native/scripts/react_native_pods.rb#L197-L202
  react_native_post_install(
    installer,
    $config[:reactNativePath],
    :mac_catalyst_enabled =&gt; false
  )
end
</code></pre>
                    <p>React_native_post_install
                    を削除すると正常に動作しますが、それは正しい解決策ではありません</p>
                    <h2 id="解決策">解決策</h2>
                    <p>この行を実行するとエラーが発生するようです</p>
                    <p>https://translate.google.com/translate?hl=ja&amp;sl=en&amp;tl=ja&amp;u=https://github.com/facebook/react-native/blob/c39538b79dbc7f84b536431ac2230d259f846e42/packages/react-native/scripts/cocoapods/utils.rb#L130</p>
                    <p>[:reactNativePath] が nil であるため</p>
                    <pre><code>File.join(&#39;&#39;, &#39;..&#39;, nil)
# TypeError: no implicit conversion of nil into String
</code></pre>
                    <p>この値を文字列として明示的に渡してみます</p>
                    <pre><code>react_native_post_install(
  installer,
  &#39;path/here&#39;,
  :mac_catalyst_enabled =&gt; false
)
</code></pre>
        </article>
    </div>
  </main>
  <footer>
    <div class="container">
        <p>&copy; 2024 Techioz. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>