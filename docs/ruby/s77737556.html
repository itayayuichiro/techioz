<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../style.css">
  <title>Apple Silicon M2 に ffi バージョン 1.11.1 をインストールする方法 | Techioz</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1637770322917058"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRM1ZRNLDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DRM1ZRNLDN');
  </script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "headline": "Apple Silicon M2 に ffi バージョン 1.11.1 をインストールする方法",
  "author": {
    "@type": "Person",
    "address": "",
    "email": null,
    "identifier": "masyumaroking",
    "name": "masyumaroking"
  },
  "publisher": {
    "@type": "Person",
    "name": "masyumaroking"
  }
}
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <div class="container">
        <h1>Techioz Blog</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>
  <main>
    <div class="container">
        <article>
                      <h2>Apple Silicon M2 に ffi バージョン 1.11.1
をインストールする方法</h2>
                    <h2 id="概要">概要</h2>
                    <p>バンドルインストールを使用して ffi 1.11.1
                    をインストールしようとしていますが、次のエラーが発生します。</p>
                    <pre><code>An error occurred while installing ffi (1.11.1), and Bundler cannot continue.
Make sure that `gem install ffi -v &#39;1.11.1&#39; --source &#39;http://rubygems.org/&#39;` succeeds before bundling.

In Gemfile:
  spree was resolved to 3.1.3, which depends on
    spree_backend was resolved to 3.1.3, which depends on
      bootstrap-sass was resolved to 3.3.7, which depends on
        sass was resolved to 3.7.4, which depends on
          sass-listen was resolved to 4.0.0, which depends on
            rb-inotify was resolved to 0.10.0, which depends on
              ffi
</code></pre>
                    <p>それで私は求められたことをしました。コマンドを実行しました:</p>
                    <p>gem install ffi -v ‘1.11.1’ –source
                    ‘http://rubygems.org/’</p>
                    <p>次に、このエラーが発生します:</p>
                    <pre><code>Building native extensions.  This could take a while...
ERROR:  Error installing ffi:
    ERROR: Failed to build gem native extension.

    current directory: /Users/marialuisagako/.rbenv/versions/2.3.6/lib/ruby/gems/2.3.0/gems/ffi-1.11.1/ext/ffi_c
/Users/marialuisagako/.rbenv/versions/2.3.6/bin/ruby -r ./siteconf20231230-1767-1obffxv.rb extconf.rb
checking for ffi_call() in -lffi... yes
checking for ffi_closure_alloc()... yes
checking for shlwapi.h... no
checking for rb_thread_call_without_gvl()... yes
checking for ruby_native_thread_p()... yes
checking for ruby_thread_has_gvl_p()... yes
checking for ffi_prep_cif_var()... yes
checking for ffi_raw_call()... yes
checking for ffi_prep_raw_closure()... yes
creating extconf.h
creating Makefile

To see why this extension failed to compile, please check the mkmf.log which can be found here:

  /Users/marialuisagako/.rbenv/versions/2.3.6/lib/ruby/gems/2.3.0/extensions/-darwin-23/2.3.0-static/ffi-1.11.1/mkmf.log

current directory: /Users/marialuisagako/.rbenv/versions/2.3.6/lib/ruby/gems/2.3.0/gems/ffi-1.11.1/ext/ffi_c
make &quot;DESTDIR=&quot; clean

current directory: /Users/marialuisagako/.rbenv/versions/2.3.6/lib/ruby/gems/2.3.0/gems/ffi-1.11.1/ext/ffi_c
make &quot;DESTDIR=&quot;
compiling Thread.c
compiling Buffer.c
Buffer.c:266:45: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
        return order == BIG_ENDIAN ? ID2SYM(rb_intern(&quot;big&quot;)) : ID2SYM(rb_intern(&quot;little&quot;));
                                            ^~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Buffer.c:266:45: note: &#39;{&#39; token is here
        return order == BIG_ENDIAN ? ID2SYM(rb_intern(&quot;big&quot;)) : ID2SYM(rb_intern(&quot;little&quot;));
                                            ^~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Buffer.c:266:45: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
        return order == BIG_ENDIAN ? ID2SYM(rb_intern(&quot;big&quot;)) : ID2SYM(rb_intern(&quot;little&quot;));
                                            ^~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }

    ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Buffer.c:266:72: note: &#39;)&#39; token is here
        return order == BIG_ENDIAN ? ID2SYM(rb_intern(&quot;big&quot;)) : ID2SYM(rb_intern(&quot;little&quot;));
                                                                       ^~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Buffer.c:276:23: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            if (id == rb_intern(&quot;little&quot;)) {
                      ^~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
Buffer.c:276:23: note: &#39;{&#39; token is here
            if (id == rb_intern(&quot;little&quot;)) {
                      ^~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
Buffer.c:276:23: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            if (id == rb_intern(&quot;little&quot;)) {
                      ^~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }
    ^
Buffer.c:276:23: note: &#39;)&#39; token is here
            if (id == rb_intern(&quot;little&quot;)) {
                      ^~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
Buffer.c:279:30: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            } else if (id == rb_intern(&quot;big&quot;) || id == rb_intern(&quot;network&quot;)) {
                             ^~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
Buffer.c:279:30: note: &#39;{&#39; token is here
            } else if (id == rb_intern(&quot;big&quot;) || id == rb_intern(&quot;network&quot;)) {
                             ^~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
Buffer.c:279:56: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            } else if (id == rb_intern(&quot;big&quot;) || id == rb_intern(&quot;network&quot;)) {
                                                       ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }
    ^
Buffer.c:279:56: note: &#39;)&#39; token is here
            } else if (id == rb_intern(&quot;big&quot;) || id == rb_intern(&quot;network&quot;)) {
                                                       ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
10 warnings generated.
compiling DynamicLibrary.c
compiling Variadic.c
Variadic.c:114:47: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
    convention = rb_hash_aref(options, ID2SYM(rb_intern(&quot;convention&quot;)));
                                              ^~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Variadic.c:114:47: note: &#39;{&#39; token is here
    convention = rb_hash_aref(options, ID2SYM(rb_intern(&quot;convention&quot;)));
                                              ^~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \

                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }
    ^
Variadic.c:132:52: note: &#39;)&#39; token is here
        VALUE typeName = rb_funcall2(rbReturnType, rb_intern(&quot;inspect&quot;), 0, NULL);
                                                   ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
Variadic.c:147:49: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            VALUE typeName = rb_funcall2(entry, rb_intern(&quot;inspect&quot;), 0, NULL);
                                                ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
Variadic.c:147:49: note: &#39;{&#39; token is here
            VALUE typeName = rb_funcall2(entry, rb_intern(&quot;inspect&quot;), 0, NULL);
                                                ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
Variadic.c:147:49: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
            VALUE typeName = rb_funcall2(entry, rb_intern(&quot;inspect&quot;), 0, NULL);
                                                ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }
    ^
Variadic.c:147:49: note: &#39;)&#39; token is here
            VALUE typeName = rb_funcall2(entry, rb_intern(&quot;inspect&quot;), 0, NULL);
                                                ^~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
Variadic.c:159:63: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
    rb_iv_set(self, &quot;@type_map&quot;, rb_hash_aref(options, ID2SYM(rb_intern(&quot;type_map&quot;))));
                                                              ^~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Variadic.c:159:63: note: &#39;{&#39; token is here
    rb_iv_set(self, &quot;@type_map&quot;, rb_hash_aref(options, ID2SYM(rb_intern(&quot;type_map&quot;))));
                                                              ^~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Variadic.c:159:63: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
    rb_iv_set(self, &quot;@type_map&quot;, rb_hash_aref(options, ID2SYM(rb_intern(&quot;type_map&quot;))));
                                                              ^~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1723:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    }
    ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Variadic.c:159:63: note: &#39;)&#39; token is here
    rb_iv_set(self, &quot;@type_map&quot;, rb_hash_aref(options, ID2SYM(rb_intern(&quot;type_map&quot;))));
                                                              ^~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:406:29: note: expanded from macro &#39;ID2SYM&#39;
#define ID2SYM(x) RB_ID2SYM(x)
                            ^
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:401:33: note: expanded from macro &#39;RB_ID2SYM&#39;
#define RB_ID2SYM(x) (rb_id2sym(x))
                                ^
Variadic.c:204:56: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
                rbType = rb_const_get(rbffi_TypeClass, rb_intern(&quot;INT32&quot;));
                                                       ^~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:23: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                      ^
Variadic.c:204:56: note: &#39;{&#39; token is here
                rbType = rb_const_get(rbffi_TypeClass, rb_intern(&quot;INT32&quot;));
                                                       ^~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:24: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1726:37: note: expanded from macro &#39;CONST_ID_CACHE&#39;
#define CONST_ID_CACHE(result, str) RUBY_CONST_ID_CACHE(result, str)
                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1718:5: note: expanded from macro &#39;RUBY_CONST_ID_CACHE&#39;
    {                                                   \
    ^
Variadic.c:204:56: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
                rbType = rb_const_get(rbffi_TypeClass,                          
                                    
MemoryPointer.c:165:21: note: &#39;)&#39; token is here
    rb_funcall(obj, rb_intern(&quot;put_string&quot;), 2, INT2FIX(0), s);
                    ^~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
2 warnings generated.
compiling Platform.c
compiling LongDouble.c
LongDouble.c:24:43: warning: &#39;(&#39; and &#39;{&#39; tokens introducing statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
        return rb_funcall(rb_cBigDecimal, rb_intern(&quot;new&quot;), 1, rb_str_new(buf, sprintf(buf, &quot;%.35Le&quot;, ld)));
                                          ^~~~~~~~~~~~~~~~
                                                        
                      ^
LongDouble.c:38:64: note: &#39;{&#39; token is here
    if (!RTEST(rb_cBigDecimal) &amp;&amp; rb_const_defined(rb_cObject, rb_intern(&quot;BigDecimal&quot;))) {
                                                                                              
Function.c:912:22: warning: &#39;}&#39; and &#39;)&#39; tokens terminating statement expression appear in different macro expansion contexts [-Wcompound-token-split-by-macro]
    id_from_native = rb_intern(&quot;from_native&quot;);

    ^
Function.c:912:22: note: &#39;)&#39; token is here
    id_from_native = rb_intern(&quot;from_native&quot;);
                     ^~~~~~~~~~~~~~~~~~~~~~~~
/Users/marialuisagako/.rbenv/versions/2.3.6/include/ruby-2.3.0/ruby/ruby.h:1733:51: note: expanded from macro &#39;rb_intern&#39;
        __extension__ (CONST_ID_CACHE((ID), (str))) : \
                                                  ^
10 warnings and 1 error generated.
make: *** [Function.o] Error 1

make failed, exit code 2
</code></pre>
                    <p>以前は修正できたが修正できなかったリンク:</p>
                    <p>https://translate.google.com/translate?hl=ja&amp;sl=en&amp;tl=ja&amp;u=https://github.com/ffi/ffi/issues/814</p>
                    <p>M1 Mac に ffi をインストールして実行する方法</p>
                    <p>エラー: ffi
                    のインストール中にエラーが発生しました: エラー: gem
                    ネイティブ拡張機能のビルドに失敗しました</p>
                    <p>brew 経由でインストールされた libffi
                    も追加しましたが、まだ機能しません。</p>
                    <p>私もリンクしてみました</p>
                    <pre><code>ln -s /usr/local//Cellar/libffi/3.3/include/ffi.h /usr/local/include/ffi.h

ln -s /usr/local//Cellar/libffi/3.3/include/ffitarget.h /usr/local/include/ffitarget.h
</code></pre>
                    <p>しかし、エラーが発生します
                    /usr/local/include/ffi.h
                    そのようなファイルはありません</p>
                    <p>Ruby バージョン: Ruby 2.3.6p384 (2017-12-14
                    リビジョン 61254) [-darwin23]</p>
                    <h2 id="解決策">解決策</h2>
                    <p>これを実行したところ、うまくいきました:</p>
                    <pre><code>gem install ffi -v &#39;1.11.1&#39; -- --with-cflags=&quot;-Wno-error=implicit-function-declaration&quot;
</code></pre>
        </article>
    </div>
  </main>
  <footer>
    <div class="container">
        <p>&copy; 2024 Techioz. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>