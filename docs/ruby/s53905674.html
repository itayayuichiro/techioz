<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../style.css">
  <title>ハッシュをハッシュの配列に変換する | Techioz</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1637770322917058"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRM1ZRNLDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DRM1ZRNLDN');
  </script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "headline": "ハッシュをハッシュの配列に変換する",
  "author": {
    "@type": "Person",
    "address": "",
    "email": null,
    "identifier": "masyumaroking",
    "name": "masyumaroking"
  },
  "publisher": {
    "@type": "Person",
    "name": "masyumaroking"
  }
}
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <div class="container">
        <h1>Techioz Blog</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>
  <main>
    <div class="container">
        <article>
                      <h2>ハッシュをハッシュの配列に変換する</h2>
                    <h2 id="概要">概要</h2>
                    <p>ハッシュがあり、そのすべての値は次のような配列です。</p>
                    <pre><code>list = { letter:  [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],
         number:  [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;],
         fruit:   [&#39;apple&#39;, &#39;pear&#39;, &#39;kiwi&#39;],
         car:     [&#39;vw&#39;, &#39;mb&#39;, &#39;bmw&#39;],
         state:   [&#39;la&#39;, &#39;ny&#39;, &#39;fl&#39;],
         color:   [&#39;red&#39;, &#39;white&#39;, &#39;black&#39;],
         tree:    [&#39;oak&#39;, &#39;pine&#39;, &#39;maple&#39;],
         animal:  [&#39;cat&#39;, &#39;dog&#39;, &#39;rat&#39;],
         clothes: [&#39;tie&#39;, &#39;sock&#39;, &#39;glove&#39;] }
</code></pre>
                    <p>実際、このハッシュにはさらに多くのキーがあり、値が大きくなる可能性がありますが、すべての値のサイズは常に同じです
                    (この場合は 3)。</p>
                    <p>このハッシュをハッシュの配列に変換したいと考えています。</p>
                    <p>各ハッシュには、元のハッシュのすべてのキーとそれぞれの値が含まれます。</p>
                    <p>それで最後に私は次のようにしたいです:</p>
                    <pre><code>list = [
  { letter: &#39;a&#39;, number: &#39;one&#39;, fruit: &#39;apple&#39;, car: &#39;vw&#39;, state: &#39;la&#39;,
    color: &#39;red&#39;, tree: &#39;oak&#39;, animal: &#39;cat&#39;, clothes: &#39;tie&#39; },

  { letter: &#39;b&#39;, number: &#39;two&#39;, fruit: &#39;pear&#39;, car: &#39;mb&#39;, state: &#39;ny&#39;,
    color: &#39;white&#39;, tree: &#39;pine&#39;, animal: &#39;dog&#39;, clothes: &#39;sock&#39; },

  { letter: &#39;c&#39;, number: &#39;three&#39;, fruit: &#39;kiwi&#39;, car: &#39;bmw&#39;, state: &#39;fl&#39;,
    color: &#39;black&#39;, tree: &#39;elm&#39;, animal: &#39;rat&#39;, clothes: &#39;glove&#39; }
]
</code></pre>
                    <p>最善の方法は何ですか?</p>
                    <h2 id="解決策">解決策</h2>
                    <pre><code>[list.keys].product(list.values.transpose).map { |a| a.transpose.to_h }
   #=&gt; [{:letter=&gt;&quot;a&quot;, :number=&gt;&quot;one&quot;, :fruit=&gt;&quot;apple&quot;, :car=&gt;&quot;vw&quot;, 
   #     :state=&gt;&quot;la&quot;, :color=&gt;&quot;red&quot;, :tree=&gt;&quot;oak&quot;, :animal=&gt;&quot;cat&quot;,
   #     :clothes=&gt;&quot;tie&quot;},
   #    {:letter=&gt;&quot;b&quot;, :number=&gt;&quot;two&quot;, :fruit=&gt;&quot;pear&quot;, :car=&gt;&quot;mb&quot;,
   #     :state=&gt;&quot;ny&quot;, :color=&gt;&quot;white&quot;, :tree=&gt;&quot;pine&quot;, :animal=&gt;&quot;dog&quot;,
   #     :clothes=&gt;&quot;sock&quot;},
   #    {:letter=&gt;&quot;c&quot;, :number=&gt;&quot;three&quot;, :fruit=&gt;&quot;kiwi&quot;, :car=&gt;&quot;bmw&quot;,
   #     :state=&gt;&quot;fl&quot;, :color=&gt;&quot;black&quot;, :tree=&gt;&quot;maple&quot;, :animal=&gt;&quot;rat&quot;, 
   #     :clothes=&gt;&quot;glove&quot;}]
</code></pre>
                    <p>リストが次のように定義されているとします。</p>
                    <pre><code>list = {
  letter:  [&#39;a&#39;,     &#39;b&#39;   ],
  number:  [&#39;one&#39;,   &#39;two&#39; ],
  fruit:   [&#39;apple&#39;, &#39;pear&#39;],
  car:     [&#39;vw&#39;,    &#39;mb&#39;  ]
}
</code></pre>
                    <p>手順は次のようになります。</p>
                    <pre><code>b = [list.keys]
  #=&gt; [[:letter, :number, :fruit, :car]]
c = list.values
  #=&gt; [[&quot;a&quot;, &quot;b&quot;], [&quot;one&quot;, &quot;two&quot;], [&quot;apple&quot;, &quot;pear&quot;], [&quot;vw&quot;, &quot;mb&quot;]]
d = c.transpose
  #=&gt; [[&quot;a&quot;, &quot;one&quot;, &quot;apple&quot;, &quot;vw&quot;],
  #    [&quot;b&quot;, &quot;two&quot;, &quot;pear&quot;,  &quot;mb&quot;]]
e = b.product(d)
  #=&gt; [[[:letter, :number, :fruit, :car], [&quot;a&quot;, &quot;one&quot;, &quot;apple&quot;, &quot;vw&quot;]],
  #    [[:letter, :number, :fruit, :car], [&quot;b&quot;, &quot;two&quot;, &quot;pear&quot;,  &quot;mb&quot;]]]
e.map { |a| a.transpose.to_h }
  #=&gt; [{:letter=&gt;&quot;a&quot;, :number=&gt;&quot;one&quot;, :fruit=&gt;&quot;apple&quot;, :car=&gt;&quot;vw&quot;},
  #    {:letter=&gt;&quot;b&quot;, :number=&gt;&quot;two&quot;, :fruit=&gt;&quot;pear&quot;,  :car=&gt;&quot;mb&quot;}]
</code></pre>
                    <p>最後のステップを詳しく見てみましょう。 map は e
                    の最初の要素をブロックに渡し、ブロック変数 a
                    をその値に設定します。</p>
                    <pre><code>a = e.first
  #=&gt; [[:letter, :number,  :fruit,  :car],
  #    [&quot;a&quot;,     &quot;one&quot;,    &quot;apple&quot;, &quot;vw&quot;]]
</code></pre>
                    <p>ブロック計算は以下のようになります。</p>
                    <pre><code>f = a.transpose
  #=&gt; [[:letter, &quot;a&quot;], [:number, &quot;one&quot;], [:fruit, &quot;apple&quot;], [:car,   &quot;vw&quot;]]
f.to_h
  #=&gt; {:letter=&gt;&quot;a&quot;, :number=&gt;&quot;one&quot;, :fruit=&gt;&quot;apple&quot;, :car=&gt;&quot;vw&quot;}
</code></pre>
                    <p>e.map { |a| の残りの計算a.transpose.to_h }
                    も同様です。</p>
        </article>
    </div>
  </main>
  <footer>
    <div class="container">
        <p>&copy; 2024 Techioz. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>