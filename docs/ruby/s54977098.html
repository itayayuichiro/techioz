<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../style.css">
  <title>使用している Ruby のバージョンを変更する方法 | Techioz</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1637770322917058"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRM1ZRNLDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DRM1ZRNLDN');
  </script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "headline": "使用している Ruby のバージョンを変更する方法",
  "author": {
    "@type": "Person",
    "address": "",
    "email": null,
    "identifier": "masyumaroking",
    "name": "masyumaroking"
  },
  "publisher": {
    "@type": "Person",
    "name": "masyumaroking"
  }
}
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <div class="container">
        <h1>Techioz Blog</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>
  <main>
    <div class="container">
        <article>
                      <h2>使用している Ruby
のバージョンを変更する方法</h2>
                    <h2 id="概要">概要</h2>
                    <p>2.5.3 を実行する必要があります。私は brew
                    を使って Ruby のインストールを管理しています
                    (私のマシンでは RVM
                    を動作させることができなかったため)。走るとき</p>
                    <pre><code>$ruby -v
</code></pre>
                    <p>分かりました</p>
                    <pre><code>ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]
</code></pre>
                    <p>ただし、使用して更新しようとすると、</p>
                    <pre><code>brew upgrade ruby
</code></pre>
                    <p>分かりました</p>
                    <pre><code>Error: ruby 2.6.1 already installed
</code></pre>
                    <p>実際にインストールした Ruby
                    のバージョンとこれほど一貫性がないのはなぜですか?</p>
                    <h2 id="解決策">解決策</h2>
                    <p>Ruby の複数のバージョンを管理するには、Ruby
                    バージョン
                    マネージャーを使用する必要があります。私は rbenv
                    を使用することを好みます。 Mac
                    にインストールする手順は次のとおりです
                    (何が行われるのか、その理由が詳しく説明されています。ショートカットが必要な場合は、すべてのコマンドを順番に実行してみてください。ただし、手順を最後まで読むことを強くお勧めします)。</p>
                    <p>実際のインストールに進む前に、次の点に注意してください。</p>
                    <p>次のコマンドを実行して、rbenv
                    リポジトリのクローンをホーム ディレクトリの .rbenv
                    ディレクトリに作成します。</p>
                    <pre><code>$ git clone https://github.com/rbenv/rbenv.git ~/.rbenv
</code></pre>
                    <p>あなたのシステムはまだ rbenv
                    がどこにあるかを知りません。以下を実行してパスに追加します。</p>
                    <pre><code>$ echo &#39;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&#39; &gt;&gt; ~/.bash_profile
</code></pre>
                    <p>ディレクトリを変更したときに Ruby
                    を変更できるように rbenv
                    を初期化するには、次のコマンドを実行します。</p>
                    <pre><code>~/.rbenv/bin/rbenv init
</code></pre>
                    <p>これにより、次のようなことがわかるはずです。</p>
                    <pre><code># Load rbenv automatically by appending
# the following to ~/.bash_profile:

eval &quot;$(rbenv init -)&quot;
</code></pre>
                    <p>それで、これを実行します:</p>
                    <pre><code>echo &#39;eval &quot;$(rbenv init -)&quot;&#39; &gt;&gt; ~/.bash_profile
</code></pre>
                    <p>この時点で rbenv
                    がインストールされているはずです。コマンドラインで
                    rbenv を実行すると、次のような結果が得られます。</p>
                    <pre><code>$ rbenv
rbenv 1.1.1-39-g59785f6
Usage: rbenv &lt;command&gt; [&lt;args&gt;]

Some useful rbenv commands are:
   commands    List all available rbenv commands
   local       Set or show the local application-specific Ruby version
   global      Set or show the global Ruby version
   shell       Set or show the shell-specific Ruby version
   rehash      Rehash rbenv shims (run this after installing executables)
   version     Show the current Ruby version and its origin
   versions    List all Ruby versions available to rbenv
   which       Display the full path to an executable
   whence      List all Ruby versions that contain the given executable

See `rbenv help &lt;command&gt;&#39; for information on a specific command.
For full documentation, see: https://github.com/rbenv/rbenv#readme

</code></pre>
                    <p>注: rbenv
                    がインストールされていないという警告が表示された場合は、source
                    ~/.bash_profile
                    を実行してください。これにより、~/.bash_profile
                    スクリプトが再実行され、パスに rbenv
                    が取得されます。その後は問題なく rbenv
                    を実行できるはずです。</p>
                    <p>rbenv には Ruby
                    をインストールまたはアンインストールするオプションがまだ提供されていないことに注意してください。このためには、ruby-build
                    をインストールする必要があります。</p>
                    <p>rbenv install <ruby version> と入力して Ruby
                    をインストールできるように、ruby-build パッケージを
                    rbenv
                    プラグインとして追加する必要があります。必要なのは、plugins
                    ディレクトリを作成し、plugins ディレクトリにある
                    Ruby-build の git
                    リポジトリをチェックアウトすることだけです。以下を実行します。</p>
                    <pre><code>$ mkdir -p &quot;$(rbenv root)&quot;/plugins
$ git clone https://github.com/rbenv/ruby-build.git &quot;$(rbenv root)&quot;/plugins/ruby-build
</code></pre>
                    <p>ターミナル上で引数を指定せずに rbenv
                    を実行すると、使用可能なインストール
                    コマンドとアンインストール
                    コマンドが表示されるようになります。このようなもの：</p>
                    <pre><code>$ rbenv
rbenv 1.1.1-39-g59785f6
Usage: rbenv &lt;command&gt; [&lt;args&gt;]

Some useful rbenv commands are:
   commands    List all available rbenv commands
   local       Set or show the local application-specific Ruby version
   global      Set or show the global Ruby version
   shell       Set or show the shell-specific Ruby version
   install     Install a Ruby version using ruby-build
   uninstall   Uninstall a specific Ruby version
   rehash      Rehash rbenv shims (run this after installing executables)
   version     Show the current Ruby version and its origin
   versions    List all Ruby versions available to rbenv
   which       Display the full path to an executable
   whence      List all Ruby versions that contain the given executable

See `rbenv help &lt;command&gt;&#39; for information on a specific command.
For full documentation, see: https://github.com/rbenv/rbenv#readme
</code></pre>
                    <p>この出力が表示されれば、rbenv
                    は正しくインストールされています。</p>
                    <p>Ruby 2.5.3
                    をインストールするには、次のコマンドを実行します
                    (まだ実行しないでください)。</p>
                    <pre><code>rbenv install 2.5.3
</code></pre>
                    <p>数行出力され、少し時間がかかり、バージョン 2.5.3
                    がインストールされたことが表示されます。ただし、問題があります。インストールが失敗すると、特にコンパイル中に、場合によっては端末がスタックし、端末に出力が表示されなくなります。長い間
                    (永久に)
                    インストールされているように見えます。何が起こっているかに関する詳細情報を取得するには、次のコマンドを実行します。</p>
                    <pre><code>rbenv install -f -v 2.5.3
</code></pre>
                    <p>-f 引数は、rbenv
                    に指定されたバージョンを強制インストールするように指示します。したがって、すでにインストールされている場合、rbenv
                    は指定されたバージョンを再インストール
                    (基本的に上書き)
                    します。したがって、インストールが失敗した場合は、-f
                    を指定するとインストールが確実に行われます。</p>
                    <p>-v 引数は、rbenv
                    に詳細メッセージを出力するように指示します。したがって、ruby-build
                    が行うすべての処理 (コンパイル プロセスを含む)
                    が表示されます。ここでコンパイルという言葉を恐れないでください。通常は問題なくコンパイルが完了し、成功しても失敗してもシステムの
                    Ruby (Linux では sudo apt install Ruby
                    でインストールされるもの、または macOS
                    ではデフォルトで取得されるもの)
                    は変更されません。</p>
                    <p>インストールが成功したら、以下のコマンドを実行して、どのバージョンがインストールされているかを確認できます
                    (出力は以下のスニペットに含まれています)。</p>
                    <pre><code>$ rbenv versions
  system
* 2.5.3 (set by /home/ubuntu/.rbenv/version)
</code></pre>
                    <p>注: Mac では、新しくインストールされた Ruby
                    のパスは異なります。</p>
                    <p>先頭に *
                    が付いているものは現在アクティブなものです。どの
                    Ruby を実行すると、Ruby
                    のシムが入ったパスが得られるはずです。興味がある場合は、rbenv
                    のドキュメントを読んで shim
                    について知りましょう。ただし、それについて心配する必要はありません。</p>
                    <pre><code>$ which ruby 
/home/ubuntu/.rbenv/shims/ruby
</code></pre>
                    <p>rbenv は素晴らしいものですが、rbenv シェル 2.5.3
                    と rbenv シェル 2.4.5
                    を毎回書き続けるのは問題です。代わりにすべきことは、ディレクトリに
                    Ruby のバージョンを設定し、rbenv
                    のことは忘れることです。</p>
                    <p>このディレクトリ (およびサブディレクトリ)
                    内のすべての Ruby スクリプトに使用する Ruby
                    のバージョン番号を 1 行含む .ruby-version
                    という名前のファイルを作成するだけです。 cd
                    で必要なディレクトリに移動し、次を実行するだけです。</p>
                    <pre><code>echo &quot;2.5.3&quot; &gt; .ruby-version
</code></pre>
                    <p>そのディレクトリおよびサブディレクトリ内のすべての
                    Ruby スクリプトはバージョン 2.5.3 を使用します。</p>
        </article>
    </div>
  </main>
  <footer>
    <div class="container">
        <p>&copy; 2024 Techioz. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>