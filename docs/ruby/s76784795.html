<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="icon" href="../favicon.ico" />
  <link rel="stylesheet" href="../style.css">
  <title>Heroku ライブラリの問題 | Techioz</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1637770322917058"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DRM1ZRNLDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DRM1ZRNLDN');
  </script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "headline": "Heroku ライブラリの問題",
  "author": {
    "@type": "Person",
    "address": "",
    "email": null,
    "identifier": "masyumaroking",
    "name": "masyumaroking"
  },
  "publisher": {
    "@type": "Person",
    "name": "masyumaroking"
  }
}
</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <div class="container">
        <h1>Techioz Blog</h1>
        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Articles</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </nav>
    </div>
  </header>
  <main>
    <div class="container">
        <article>
                      <h2>Heroku ライブラリの問題</h2>
                    <h2 id="概要">概要</h2>
                    <p>Ruby on Rails プロジェクトを持ち込まれました。
                    Ruby
                    についてはまったくわかりませんが、コードを変更する必要はありません。問題は図書館です。
                    Windows で生成されたため、Heraku が Heroku Removing
                    Gemfile.lock
                    を案内してくれたというエラーが発生しました。これは私が期待していたほど役に立ちませんでした。
                    Gemfile
                    には、回答で言及されているライブラリへの参照が含まれていませんでした。私は
                    Windows
                    に関連している可能性があるものを見つけようと試み始めました。ただし、ファイルには何も追加せず、バージョン番号を更新しただけです。私が使用していた
                    Gemfile は Heroku
                    のプロジェクトから直接取得したものです。 Windows
                    関連のものがどのように追加されたのかわかりません。とにかく、何を求めているのか全く分かりません。
                    Heroku が好まない Gemfile は次のとおりです。</p>
                    <pre><code>ruby &#39;3.2.2&#39;
source &#39;https://rubygems.org&#39;
gem &#39;bundler&#39;, &#39;&gt;= 2.4.10&#39;
gem &#39;rails&#39;, &#39;7.0.5&#39;
gem &#39;coffee-rails&#39;, &#39;~&gt; 5.0.0&#39;
group :production, :staging do
  gem &#39;rails_12factor&#39;
end
gem &#39;skylight&#39;, &#39;~&gt; 5.3.4&#39;
gem &#39;newrelic_rpm&#39;
gem &#39;puma&#39;
gem &#39;pg&#39;
gem &#39;sass-rails&#39;, &#39;~&gt; 6.0.0&#39;
gem &#39;font-awesome-rails&#39;
gem &#39;bootstrap-sass&#39;
gem &#39;bootstrap-datepicker-rails&#39;
gem &#39;bootstrap-will_paginate&#39;
gem &#39;twitter-bootstrap-rails-confirm&#39;, &#39;~&gt; 2.0.2&#39;
gem &#39;chartjs-ror&#39;, &#39;~&gt; 3.7.0&#39; # git: &#39;git://github.com/paulstefanort/chartjs-ror.git&#39;, ref: &#39;3b6184ac39&#39;
gem &#39;jquery-datatables-rails&#39;, &#39;~&gt; 3.4.0&#39;
gem &#39;jquery-ui-rails&#39;
gem &#39;local_time&#39;
gem &#39;devise&#39;
gem &#39;jwt&#39;
gem &#39;paperclip&#39;
gem &#39;aws-sdk&#39;, &#39;&lt; 2.0&#39;
gem &#39;foreman&#39;
gem &#39;uglifier&#39;, &#39;&gt;= 4.2.0&#39;
gem &#39;jquery-rails&#39;
gem &#39;jbuilder&#39;, &#39;~&gt; 2.11.5&#39;
group :development, :test do
  gem &#39;byebug&#39;
  gem &#39;web-console&#39;, &#39;~&gt; 4.2.0&#39;
  gem &#39;spring&#39;
end
gem &#39;spring-commands-rspec&#39;, group: [:development, :test]
gem &#39;rspec-rails&#39;, group: [:development, :test]
group :development do
  gem &#39;sexp_processor&#39;
  gem &#39;flog&#39;
  gem &#39;better_errors&#39;
end
group :test do
  gem &#39;shoulda-matchers&#39;, require: false
  gem &#39;guard-rspec&#39;
  gem &#39;simplecov&#39;, require: false
  gem &#39;factory_girl_rails&#39;
  gem &#39;faker&#39;
  gem &#39;capybara&#39;
  gem &#39;capybara-webkit&#39;
  gem &#39;rspec-sidekiq&#39;
  gem &#39;database_cleaner&#39;
end
gem &#39;dotenv-deployment&#39;, group: [:development, :test]
gem &#39;date_validator&#39;
gem &#39;country_select&#39;
gem &#39;active_model_serializers&#39;
gem &#39;mail&#39;
gem &#39;zbase32&#39;, github: &#39;paulstefanort/zbase32-ruby&#39;
gem &#39;lol_dba&#39;, group: :development
gem &#39;chosen-rails&#39;
#gem &#39;chosen-sass-bootstrap-rails&#39;, github: &#39;caarlos0-graveyard/chosen-sass-bootstrap-rails&#39;
gem &#39;mandrill-rails&#39;
gem &#39;griddler&#39;, &#39;1.5.2&#39;
gem &#39;griddler-sendgrid&#39;, &#39;1.2.0&#39;
gem &#39;gcm&#39;
gem &#39;pusher&#39;
gem &#39;twilio-ruby&#39;
gem &#39;sidekiq&#39;
gem &#39;sidekiq-limit_fetch&#39;
gem &#39;rack-mini-profiler&#39;, require: false
gem &#39;sinatra&#39;, require: false
#gem &#39;quarry&#39;, github: &#39;paulstefanort/quarry&#39;
gem &#39;keen&#39;
gem &#39;react-rails&#39;, &#39;~&gt; 2.7.1&#39;, github: &#39;reactjs/react-rails&#39;
gem &#39;airbrake&#39;
#gem &#39;rbtrace&#39;
gem &#39;countries&#39;
#gem &#39;rmagick&#39;, &#39;5.2.0&#39;
source &#39;https://rails-assets.org&#39; do
  gem &#39;rails-assets-react-bootstrap&#39;
end
</code></pre>
                    <p>何を探しているのか、何を変更すればよいのか誰か教えていただけますか?</p>
                    <h2 id="解決策">解決策</h2>
                    <p>Heroku でこのような警告が表示された場合</p>
                    <pre><code>Removing `Gemfile.lock` because it was generated on Windows.
Bundler will do a full resolve so native gems are handled properly.
This may result in unexpected gem versions being used in your app.
</code></pre>
                    <p>その場合、問題は、Windows
                    でのみ利用可能で他のプラットフォームでは利用できない
                    gem ではない可能性があります。ただし、この gem
                    にはプラットフォーム固有のバージョンが複数あり、Windows
                    バージョンのみがインストールされていました。</p>
                    <p>たとえば、Ruby on Rails の actiontext
                    ライブラリの推移的な依存関係である nokogri gem
                    があります。この gem
                    の各バージョンには、x86-mingw32、x86-linux、java
                    などの特定のプラットフォーム向けにネイティブにビルドされたさまざまなバージョンがあります。</p>
                    <p>Bundler
                    がさまざまなプラットフォームで正しいバージョンをロードできるようにするには、Gemfile.lock
                    を生成するときに、どのプラットフォームでアプリを使用するか、およびどの
                    gem バージョンを使用可能にしておくかを Bundler
                    に指示する必要があります。</p>
                    <p>バンドル
                    プラットフォームで現在どのプラットフォームが構成されているかを確認すると、次のような結果が返される可能性があります。</p>
                    <pre><code>PLATFORMS
  ruby
  x86-mingw32
</code></pre>
                    <p>これは、Bundler が gem の Ruby バージョン
                    (基本的にほとんどの gem のデフォルト)
                    と、異なるプラットフォームで複数のバージョンが利用可能な場合に
                    x86-mingw32
                    バージョンのみをインストールすることを意味します。</p>
                    <p>しかし、Heraku はプラットフォームを Linux
                    上で実行しています。したがって、Bundler に
                    x86_64-linux
                    プラットフォームのサポートも追加するように指示する必要があります。それが完了したら、bundle
                    install
                    を再度実行し、変更をコミットして、それらの変更を
                    Heroku にプッシュします。</p>
                    <pre><code>bundle lock --add-platform ruby    # only if `ruby` is not returned by `bundle platform`
bundle lock --add-platform x86_64-linux
bundle install

# git commit and push to Heroku
</code></pre>
                    <p>今後のアプリケーション開発で Windows
                    を使用しない場合は、次のコマンドを使用して Windows
                    を明示的に削除することをお勧めします。</p>
                    <pre><code>bundle lock --remove-platform x86-mingw32
</code></pre>
                    <p>x86-mingw32 を、bundle platform
                    コマンドによって返された Windows
                    固有のプラットフォーム文字列に変更する必要がある場合があります。</p>
                    <p>Apple Silicon で開発する場合、Intel CPU
                    x86_64-darwin を搭載した Mac の場合は、arm64-darwin
                    を追加することもできます。</p>
        </article>
    </div>
  </main>
  <footer>
    <div class="container">
        <p>&copy; 2024 Techioz. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>